//nodes
LOAD CSV WITH HEADERS FROM 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSdw0GI59_bA_-2Wb4iun7L3LkBEADTLK7V02CgkP_SMM9AjG9_qKaZydC937M9AQjVFwlduQSVs_ux/pub?gid=456873098&single=true&output=csv' AS row
CALL apoc.create.node(["Unit"], row)
YIELD node
RETURN node


//rels
LOAD CSV WITH HEADERS FROM 'https://docs.google.com/spreadsheets/d/e/2PACX-1vT9NjQcqTpLhcDwORvwQd9RUmn65u8HaJPocCo_decYMh3WyoyG_DhyI7fyfsd24RVvtP3CVQQz-TnU/pub?gid=1686790187&single=true&output=csv' AS row
MATCH (child:Unit {unitcode: row.child_unit}), (parent:Unit {unitcode: row.parent_unit})
CALL apoc.create.relationship(child, row.relationship, {}, parent)
YIELD rel
RETURN rel

//return prereqs chosen unit
MATCH (u:Unit {unitcode: "ENSC2004"})
CALL apoc.path.expandConfig(u, {relationshipFilter: "REQUIRES>", minLevel: 1, maxLevel: 5})
YIELD path
RETURN [node IN nodes(path) | node.unitcode] AS prerequisites


//return units that requires chosen unit
MATCH (u:Unit {unitcode: "ENSC2004"})
CALL apoc.path.expandConfig(u, {relationshipFilter: "<REQUIRES", minLevel: 1, maxLevel: 5})
YIELD path
RETURN [node IN nodes(path) | node.unitcode] AS child_units