//nodes
LOAD CSV WITH HEADERS FROM 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRD2xWMGyEr2Zc7piy7AwtwfLahrtfe740tBUAYbJ2JJDD23J-IUr-zjMFvBW3gSwUDYywcYQBzq5UO/pub?gid=1587961655&single=true&output=csv' AS row
CALL apoc.create.node(["Unit"], row)
YIELD node
RETURN node


//rels
LOAD CSV WITH HEADERS FROM 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQP5WQa-uyd7vr3Fwi-7eEPZSCdSVZ2TDw-yfMtWeJNZmXjITYXDB170uwQ_1MbOjioW_paYc9SPPk7/pub?gid=977693252&single=true&output=csv' AS row
MATCH (child:Unit {unitcode: row.child_unit}), (parent:Unit {unitcode: row.parent_unit})
CALL apoc.create.relationship(child, row.relationship, {}, parent)
YIELD rel
RETURN rel

//return prereqs chosen unit
MATCH (u:Unit {unitcode: "ENSC2004"})
CALL apoc.path.expandConfig(u, {relationshipFilter: "REQUIRES>", minLevel: 1, maxLevel: 5})
YIELD path
RETURN [node IN nodes(path) | node.unitcode] AS prerequisites


//return units that requires chosen unit
MATCH (u:Unit {unitcode: "ENSC2004"})
CALL apoc.path.expandConfig(u, {relationshipFilter: "<REQUIRES", minLevel: 1, maxLevel: 5})
YIELD path
RETURN [node IN nodes(path) | node.unitcode] AS child_units